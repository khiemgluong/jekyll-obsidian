<head>
    <style>
        #obsidian #fileread #canvas {
            position: absolute;
            height: 4000px;
            width: 4000px;
            /* https://codepen.io/mapsandapps/pen/pbzooY */
            background-color: var(--bg);
            background-image: radial-gradient(rgb(133, 137, 141) 5%, transparent 0);
            background-size: 30px 30px;
        }
    </style>
</head>

<body>
    <!-- <ul id="breadcrumb"></ul> -->
    <h3 id="canvas-title"></h3>
</body>


<script>
    function loadCanvas(canvasPath) {
        const vaultpath = '/' + '{{ site.obsidian_vault | escape }}'
        const fullFilePath = vaultpath + canvasPath;
        console.log("fullFilePath Canvas: " + fullFilePath)
        fetch(fullFilePath).then(response => {
            if (!response.ok)
                throw new Error('Network response: ' + response.statusText);
            return response.text();
        }).then(content => {
            try {
                const canvas_parsed = JSON.parse(content);
                if (!canvas_parsed.nodes || !Array.isArray(canvas_parsed.nodes)) {
                    console.error('Invalid or missing nodes array');
                    return;
                }
                const keysList = canvas_parsed.nodes.map(node => Object.keys(node));
                console.log("Canvas keysList: " + keysList);
            } catch (e) {
                console.error("Error parsing canvas:", e);
            }

        });
    }
</script>

<script>
    // document.addEventListener('DOMContentLoaded', () => {
    //     const homepage = '{{ site.obsidian_homepage | escape }}'
    //     if (homepage) {
    //         loadCanvas('/' + homepage);
    //         console.log("canvas read loaded: " + homepage);
    //     }
    // });

    document.addEventListener('obsidianCanvasSelect', function (event) {
        switchPage(event.detail);
        loadCanvas(event.detail);
    });
</script>